"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2266],{8807:(e,t,n)=>{n.d(t,{Z:()=>r});var a=n(3645),i=n.n(a)()((function(e){return e[1]}));i.push([e.id,"#admLedger{font-size:.85rem}#admLedger .p_tit{margin:auto;max-width:1500px}#admLedger .list_top{margin-bottom:2px}#admLedger .list_top div:nth-child(2){text-align:right}#admLedger .top .model .col .badge{font-size:1rem}#admLedger .fixed_header{position:relative}#admLedger .fixed_header.head{z-index:2}#admLedger .fixed_header.top .model .col .badge{position:relative;top:96px;z-index:2}#admLedger .row .list_id{flex:0 0 90px;max-width:90px;min-height:22.39px}#admLedger .row .list_id .custom-control .custom-control-label{cursor:pointer;line-height:1.5rem}#admLedger .row{align-items:center;margin:0;margin:auto;padding:5px 0;position:relative}#admLedger .row:not(.list_top) .col{line-height:1.1rem;padding-left:5px;padding-right:5px;text-align:center}#admLedger .row .model{flex-basis:auto;flex-grow:0;flex-shrink:1;flex-wrap:wrap;max-width:none;padding:0}#admLedger .ctrl{background:#fff;border-radius:0 5px 5px 0;border-right:2px solid #55aebf;color:#126b7c;left:-104px;position:absolute;text-align:right;top:50%;transform:translateY(-50%);transition:all .4s;width:120px;z-index:1}#admLedger .row .model .row{padding:0}#admLedger .row .model .row .ctrl{left:-76px;width:95px}#admLedger .ctrl:hover{left:0!important;z-index:2}.slideLeftRight-enter-to,.slideLeftRight-leave{transform:translateX(0)}.slideLeftRight-enter-active,.slideLeftRight-leave-active{transition:all .3s ease}.slideLeftRight-enter,.slideLeftRight-leave-to{opacity:0;transform:translateX(-100%)}.row .col .btn-sm{font-size:.7rem;padding:.1rem .3rem}.row .col .hidden_menu{left:0;position:absolute;z-index:2}.slide-fade-enter-active{transition:all .2s ease}.slide-fade-leave-active{transition:all .2s cubic-bezier(1,.5,.8,1)}.slide-fade-enter,.slide-fade-leave-to{opacity:0;transform:translateX(-20px)}",""]);const r=i},2266:(e,t,n)=>{n.r(t),n.d(t,{default:()=>g});var a=n(7757),i=n.n(a),r=n(4670);function o(e,t,n,a,i,r,o){try{var l=e[r](o),d=l.value}catch(e){return void n(e)}l.done?t(d):Promise.resolve(d).then(a,i)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function l(e){o(r,a,i,l,d,"next",e)}function d(e){o(r,a,i,l,d,"throw",e)}l(void 0)}))}}var d=new Date;d.format("yyyy-MM-dd");d.setDate(1);d.format("yyyy-MM-dd");const s={name:"admLedger",components:{ListTop:function(){return n.e(9014).then(n.bind(n,9014))},ListSearch:function(){return n.e(5351).then(n.bind(n,5351))},ListHead:function(){return n.e(4826).then(n.bind(n,4826))},ListData:function(){return n.e(6680).then(n.bind(n,6680))},Modal:function(){return n.e(8312).then(n.bind(n,8312))},CustomSetColumn:function(){return n.e(3058).then(n.bind(n,3058))}},data:function(){return{isModalViewed:!1,actTarget:"set_search",actType:"create",editIndex:0,isScrollPass:!1,headTop:0,ledger:{data:[]},config:{},schFrm:{},mng_list:{},mng_config:{COLUMN:[],MODEL:[]},mng_info:{},writer:[],column_list:{COLUMN:{order_dt:{w:120,name:"주문일"},pay_type:{w:120,name:"결제방식"},mng:{w:120,name:"담당자"},od_id:{w:120,name:"주문번호"},sale_dt:{w:120,name:"매출일"},distributor:{w:120,name:"매출처"},depart:{w:120,name:"소속"},lab_prof:{w:120,name:"연구실/교수님"},orderer:{w:120,name:"고객명"},od_name:{w:120,name:"주문명"},sum_ea_p:{w:120,name:"총 공급가액"},sum_surtax:{w:120,name:"총 세액"},sum_sum_p:{w:120,name:"총 합계"},tax_name:{w:120,name:"tax담당"},tax_email:{w:120,name:"tax메일"},tax_hp:{w:120,name:"tax번호"},note:{w:120,name:"비고"},created_at:{w:120,name:"작성일"},model:{w:0,name:"제품정보"}},MODEL:{gm_name:{w:250,name:"품목명"},gm_spec:{w:250,name:"사양"},catno:{w:115,name:"CAT.No"},gm_code:{w:120,name:"모델명"},gm_price:{w:90,name:"단가"},ea:{w:45,name:"수량"},ea_price:{w:130,name:"공급가액"},surtax:{w:90,name:"세액"},sum_price:{w:130,name:"합계"},com_order_dt:{w:120,name:"업체발주일"},buyer:{w:120,name:"매입처"},order_mng:{w:120,name:"발주담당"},purchase_price:{w:120,name:"매입금액"},shipping_dt:{w:120,name:"제품발송일"}}},indeterminate:!1,all_chk_cplt:!1}},computed:{row_width:function(){var e=this,t=0;return this.mng_config.COLUMN.forEach((function(n){"model"==n.umc_val?e.mng_config.MODEL.forEach((function(n){t+=e.column_list.MODEL[n.umc_val].w})):t+=e.column_list.COLUMN[n.umc_val].w})),t+90},model_width:function(){var e=this,t=0;return this.mng_config.MODEL.forEach((function(n){t+=e.column_list.MODEL[n.umc_val].w})),t},total_ea_price:function(){return this.ledger.data.reduce((function(e,t){return e+("CXL"!==t.lg_pay_type&&t.hasOwnProperty("ledger_model")?t.ledger_model.reduce((function(e,t){return e+("Y"!==t.lm_cxl?Number(t.lm_ea_price):0)}),0):0)}),0)},total_sum_price:function(){return this.ledger.data.reduce((function(e,t){return e+("CXL"!==t.lg_pay_type&&t.hasOwnProperty("ledger_model")?t.ledger_model.reduce((function(e,t){return e+("Y"!==t.lm_cxl?Number(t.lm_sum_price):0)}),0):0)}),0)}},methods:{index:function(){var e=arguments,t=this;return l(i().mark((function n(){var a,o;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(a=e.length>0&&void 0!==e[0]?e[0]:null)&&(t.schFrm.page=a),n.next=4,r.Z.get("/api/admin/ledger",{params:t.schFrm});case 4:(o=n.sent)&&200===o.status&&(t.ledger=o.data.lg,t.mng_list=o.data.mng,t.mng_config=o.data.mng_config,t.mng_info=o.data.mng_info,t.writer=o.data.writer?o.data.writer:[],t.config=o.data.config);case 6:case"end":return n.stop()}}),n)})))()},create:function(){this.ledger.data.unshift({lg_sum_ea_p:0,lg_sum_surtax:0,lg_sum_sum_p:0})},createModel:function(e){this.ledger.data[e].ledger_model.unshift({lm_lg_id:this.ledger.data[e].lg_id,lm_gm_price:0,lm_ea:0,lm_ea_price:0,lm_surtax:0,lm_sum_price:0,lm_purchase_price:0})},updateColumnComplete:function(){this.isModalViewed=!1,this.index()},all_price_update:function(){var e=this;return l(i().mark((function t(){var n,a,o,l,d;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=0,a=0,o=0,e.ledger.data[e.editIndex].ledger_model.forEach((function(e){"Y"!==e.lm_cxl&&(n+=Number(e.lm_ea_price),a+=Number(e.lm_surtax),o+=Number(e.lm_sum_price))})),e.ledger.data[e.editIndex].lg_sum_ea_p=n,e.ledger.data[e.editIndex].lg_sum_surtax=a,e.ledger.data[e.editIndex].lg_sum_sum_p=o,l={_method:"PATCH",type:"all_price_update",lg_sum_ea_p:n,lg_sum_surtax:a,lg_sum_sum_p:o},t.next=10,r.Z.post("/api/admin/ledger/".concat(e.ledger.data[e.editIndex].lg_id),l);case 10:(d=t.sent)&&200===d.status&&(e.index(),Notify.toast("success","수정 완료"));case 12:case"end":return t.stop()}}),t)})))()},chkChange:function(){var e=this.ledger.data.filter((function(e){return 1==e.chk_cplt})).length;0===e?(this.indeterminate=!1,this.allSelected=!1):e===this.ledger.data.length?(this.indeterminate=!1,this.allSelected=!0):(this.indeterminate=!0,this.allSelected=!1)},toggle_all_chk:function(e){this.ledger.data.forEach((function(t){t.chk_cplt=!!e})),this.indeterminate=!1},modal_view:function(e){this.isModalViewed=e},to_accounting:function(){var e=this;return l(i().mark((function t(){var n,a,o;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={_method:"PATCH",type:"to_accounting",lg_ids:e.ledger.data.filter((function(e){return 1==e.chk_cplt})).map((function(e){return e.lg_id}))},t.next=3,r.Z.post("/api/admin/ledger/0",n);case 3:if(!(a=t.sent)||200!==a.status){t.next=9;break}return t.next=7,r.Z.post("/api/admin/ledgerAcct",{lg:e.ledger.data});case 7:(o=t.sent)&&200===o.status&&(e.index(),Notify.toast("success","수정 완료"));case 9:case"end":return t.stop()}}),t)})))()},scrollListener:function(e){this.isScrollPass=window.scrollY>=290,this.isScrollPass?this.headTop=window.scrollY-290:this.headTop=0}},mounted:function(){this.index(),window.addEventListener("scroll",this.scrollListener)},beforeDestroy:function(){window.removeEventListener("scroll",this.scrollListener)}};var c=n(3379),m=n.n(c),_=n(8807),u={insert:"head",singleton:!1};m()(_.Z,u);_.Z.locals;const g=(0,n(1900).Z)(s,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"p_wrap",attrs:{id:"admLedger"}},[n("h3",{staticClass:"p_tit"},[e._v("영업 장부")]),e._v(" "),n("b-card",{staticClass:"shadow",style:{width:"calc( "+e.row_width+"px + 2.5rem )",marginRight:"15px"}},[n("b-row",{staticClass:"list_top"},[n("b-col",[e._v("Total : "),n("b-badge",{attrs:{variant:"info"}},[e._v(e._s(e.ledger.total))])],1)],1),e._v(" "),n("ListTop",{staticClass:"top",class:{fixed_header:e.isScrollPass},style:{width:e.row_width+"px",top:e.headTop+"px"},attrs:{mng_config:e.mng_config,column_list:e.column_list,model_width:e.model_width,total_ea_price:e.total_ea_price,total_sum_price:e.total_sum_price}}),e._v(" "),n("ListSearch",{staticClass:"search",style:{width:e.row_width+"px"},attrs:{mng_config:e.mng_config,column_list:e.column_list,model_width:e.model_width,mng_list:e.mng_list,config:e.config},on:{index:e.index},model:{value:e.schFrm,callback:function(t){e.schFrm=t},expression:"schFrm"}}),e._v(" "),n("ListHead",{staticClass:"head",class:{fixed_header:e.isScrollPass},style:{width:e.row_width+"px",top:e.headTop+"px"},attrs:{mng_config:e.mng_config,column_list:e.column_list,model_width:e.model_width,indeterminate:e.indeterminate,all_chk_cplt:e.all_chk_cplt},on:{create:e.create,modal_view:e.modal_view,toggle_all_chk:e.toggle_all_chk}}),e._v(" "),n("ListData",{staticClass:"content",style:{width:e.row_width+"px"},attrs:{ledger:e.ledger.data,mng_config:e.mng_config,column_list:e.column_list,model_width:e.model_width,config:e.config,mng_list:e.mng_list},on:{index:e.index,createModel:e.createModel,chkChange:e.chkChange}})],1),e._v(" "),n("pagination",{staticClass:"my-5",attrs:{data:e.ledger,align:"center"},on:{"pagination-change-page":e.index}}),e._v(" "),n("transition",{attrs:{name:"modal"}},[e.isModalViewed?n("Modal",{on:{"close-modal":function(t){e.isModalViewed=!1}}},[n("CustomSetColumn",{attrs:{mng_config:e.mng_config,column_list:e.column_list},on:{updateColumnComplete:e.updateColumnComplete}})],1):e._e()],1),e._v(" "),n("transition",{attrs:{name:"slideLeftRight"}},[e.ledger.data.filter((function(e){return 1==e.chk_cplt})).length?n("b-button",{staticClass:"to_accounting",on:{click:e.to_accounting}},[e._v("회계전송")]):e._e()],1)],1)}),[],!1,null,null,null).exports}}]);