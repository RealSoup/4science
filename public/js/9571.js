"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9571],{8807:(e,t,a)=>{a.d(t,{Z:()=>i});var r=a(3645),n=a.n(r)()((function(e){return e[1]}));n.push([e.id,"#admLedger{font-size:.85rem}#admLedger .p_tit{margin:auto;max-width:1500px}#admLedger .data .list_top{margin-bottom:2px}#admLedger .data .list_top div:nth-child(2){text-align:right}#admLedger .data .ledger_module .row .list_id{flex:0 0 90px;max-width:90px}#admLedger .data .ledger_module .row .list_id .custom-control{margin-left:1.5rem;padding-left:0}#admLedger .data .ledger_module .row .list_id .custom-control .custom-control-label{cursor:pointer;line-height:1.5rem}#admLedger .data .ledger_module .row{align-items:center;margin:0;position:relative}#admLedger .data .ledger_module>.row{margin:auto}#admLedger .data .ledger_module .row .col{line-height:1.1rem;padding-left:5px;padding-right:5px;text-align:center}#admLedger .data .ledger_module .row .model{flex-basis:auto;flex-grow:0;flex-shrink:1;flex-wrap:wrap;max-width:none;min-height:28px;padding:0}#admLedger .data .ledger_module .ctrl{background:#fff;border-radius:0 5px 5px 0;border-right:2px solid #55aebf;color:#126b7c;left:-104px;position:absolute;text-align:right;top:50%;transform:translateY(-50%);transition:all .4s;width:120px;z-index:1}#admLedger .data .ledger_module .row .model .row .ctrl{left:-76px;width:95px}#admLedger .data .ledger_module .ctrl:hover{left:0!important;z-index:2}#admLedger .data .ps .ps__rail-x{height:25px;position:fixed;z-index:1}#admLedger .data .ps .ps__rail-x:hover{background-color:#eee;opacity:.9}#admLedger .data .ps .ps__rail-x .ps__thumb-x{background-color:pink;height:18px;position:fixed}#admLedger .data .ps .ps__rail-x.ps--clicking .ps__thumb-x,#admLedger .data .ps .ps__rail-x:focus>.ps__thumb-x,#admLedger .data .ps .ps__rail-x:hover>.ps__thumb-x{background-color:hotpink;height:22px}#admLedger .to_accounting{border-radius:0 10px 10px 0;left:0;padding:2px 8px;position:fixed;top:47%;width:40px;-ms-writing-mode:tb-lr;writing-mode:vertical-lr;z-index:1}.slideLeftRight-enter-to,.slideLeftRight-leave{transform:translateX(0)}.slideLeftRight-enter-active,.slideLeftRight-leave-active{transition:all .3s ease}.slideLeftRight-enter,.slideLeftRight-leave-to{opacity:0;transform:translateX(-100%)}",""]);const i=n},9571:(e,t,a)=>{a.r(t),a.d(t,{default:()=>h});var r=a(7757),n=a.n(r),i=a(4670);function l(e,t,a,r,n,i,l){try{var d=e[i](l),o=d.value}catch(e){return void a(e)}d.done?t(o):Promise.resolve(o).then(r,n)}function d(e){return function(){var t=this,a=arguments;return new Promise((function(r,n){var i=e.apply(t,a);function d(e){l(i,r,n,d,o,"next",e)}function o(e){l(i,r,n,d,o,"throw",e)}d(void 0)}))}}var o=new Date,c=o.format("yyyy-MM-dd");o.setDate(1);var m=o.format("yyyy-MM-dd");const _={name:"admLedger",components:{Search:function(){return a.e(5626).then(a.bind(a,5626))},Modal:function(){return a.e(9489).then(a.bind(a,9489))},FormLedger:function(){return a.e(3967).then(a.bind(a,3967))},FormLedgerModel:function(){return a.e(3877).then(a.bind(a,8155))},ListHead:function(){return a.e(4630).then(a.bind(a,4630))},ListData:function(){return a.e(3492).then(a.bind(a,3492))},CustomSetColumn:function(){return a.e(8541).then(a.bind(a,8541))},CustomSetSearch:function(){return a.e(1559).then(a.bind(a,1559))}},data:function(){return{isModalViewed:!1,actTarget:"set_search",actType:"create",editIndex:0,isScrollPass:!1,ledger:{data:[]},config:{},frm_ledger:{},frm_ledger_model:{},schFrm:{startDate:m,endDate:c},mng_list:{},user_mng_config:{COLUMN:[],SEARCH:[],MODEL:[]},mng_info:{},writer:[],sch_item_list:{created_at:{name:"작성일",umc_val:"created_at"},gm_price:{name:"단가",umc_val:"gm_price"},ea_price:{name:"공급가액",umc_val:"ea_price"},surtax:{name:"세액",umc_val:"surtax"},sum_price:{name:"합계",umc_val:"sum_price"},mng:{name:"담당자",umc_val:"mng"},pay_type:{name:"결제방식",umc_val:"pay_type"},orderer:{name:"고객명",umc_val:"orderer"},od_id:{name:"번호",umc_val:"od_id"},distributor:{name:"매출처",umc_val:"distributor"},gm_name:{name:"품목명",umc_val:"gm_name"},catno:{name:"CAT.No  ",umc_val:"catno"},gm_code:{name:"모델명",umc_val:"gm_code"},writer:{name:"작성자",umc_val:"writer"}},column_list_clmn:{order_dt:{w:120,umc_val:"order_dt",name:"주문일"},pay_type:{w:120,umc_val:"pay_type",name:"결제방식"},mng:{w:120,umc_val:"mng",name:"담당자"},od_id:{w:120,umc_val:"od_id",name:"주문번호"},sale_dt:{w:120,umc_val:"sale_dt",name:"매출일"},distributor:{w:120,umc_val:"distributor",name:"매출처"},depart:{w:120,umc_val:"depart",name:"소속"},lab_prof:{w:120,umc_val:"lab_prof",name:"연구실/교수님"},orderer:{w:120,umc_val:"orderer",name:"고객명"},od_name:{w:120,umc_val:"od_name",name:"주문명"},sum_ea_p:{w:120,umc_val:"sum_ea_p",name:"총 공급가액"},sum_surtax:{w:120,umc_val:"sum_surtax",name:"총 세액"},sum_sum_p:{w:120,umc_val:"sum_sum_p",name:"총 합계"},tax_name:{w:120,umc_val:"tax_name",name:"tax담당"},tax_email:{w:120,umc_val:"tax_email",name:"tax메일"},tax_hp:{w:120,umc_val:"tax_hp",name:"tax번호"},note:{w:120,umc_val:"note",name:"비고"},created_at:{w:120,umc_val:"created_at",name:"작성일"},model:{w:0,umc_val:"model",name:"제품정보"}},column_list_model:{gm_name:{w:250,umc_val:"gm_name",name:"품목명"},gm_spec:{w:250,umc_val:"gm_spec",name:"사양"},catno:{w:115,umc_val:"catno",name:"CAT.No"},gm_code:{w:120,umc_val:"gm_code",name:"모델명"},gm_price:{w:90,umc_val:"gm_price",name:"단가"},ea:{w:45,umc_val:"ea",name:"수량"},ea_price:{w:130,umc_val:"ea_price",name:"공급가액"},surtax:{w:90,umc_val:"surtax",name:"세액"},sum_price:{w:130,umc_val:"sum_price",name:"합계"},com_order_dt:{w:120,umc_val:"com_order_dt",name:"업체발주일"},buyer:{w:120,umc_val:"buyer",name:"매입처"},order_mng:{w:120,umc_val:"order_mng",name:"발주담당"},purchase_price:{w:120,umc_val:"purchase_price",name:"매입금액"},shipping_dt:{w:120,umc_val:"shipping_dt",name:"제품발송일"}},indeterminate:!1,all_chk_cplt:!1}},computed:{row_width:function(){var e=this,t=0;return this.user_mng_config.COLUMN.forEach((function(a){"model"==a.umc_val?e.user_mng_config.MODEL.forEach((function(a){t+=e.column_list_model[a.umc_val].w})):t+=e.column_list_clmn[a.umc_val].w})),t+90},model_width:function(){var e=this,t=0;return this.user_mng_config.MODEL.forEach((function(a){t+=e.column_list_model[a.umc_val].w})),t},total_ea_price:function(){return this.ledger.data.reduce((function(e,t){return e+("CXL"!==t.lg_pay_type?t.ledger_model.reduce((function(e,t){return e+("Y"!==t.lm_cxl?Number(t.lm_ea_price):0)}),0):0)}),0)},total_sum_price:function(){return this.ledger.data.reduce((function(e,t){return e+("CXL"!==t.lg_pay_type?t.ledger_model.reduce((function(e,t){return e+("Y"!==t.lm_cxl?Number(t.lm_sum_price):0)}),0):0)}),0)}},methods:{index:function(){var e=arguments,t=this;return d(n().mark((function a(){var r,l;return n().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return(r=e.length>0&&void 0!==e[0]?e[0]:null)&&(t.schFrm.page=r),a.next=4,i.Z.get("/api/admin/ledger",{params:t.schFrm});case 4:(l=a.sent)&&200===l.status&&(t.ledger=l.data.lg,t.mng_list=l.data.mng,t.user_mng_config=l.data.user_mng_config,t.mng_info=l.data.mng_info,t.writer=l.data.writer?l.data.writer:[],t.config=l.data.config);case 6:case"end":return a.stop()}}),a)})))()},create:function(e,t){this.isModalViewed=!0,this.actTarget=e,this.actType="create","child"==e&&(this.frm_ledger_model={},this.frm_ledger_model.lm_lg_id=this.ledger.data[t].lg_id)},editSearch:function(){this.isModalViewed=!0,this.actTarget="editSearch"},editColumn:function(){this.isModalViewed=!0,this.actTarget="editColumn"},updateColumnComplete:function(){this.isModalViewed=!1,this.index()},updateSearchComplete:function(){this.isModalViewed=!1,this.index()},store:function(e){var t=this;return d(n().mark((function a(){var r;return n().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,i.Z.post("/api/admin/ledger",e);case 2:(r=a.sent)&&200===r.status&&(t.index(),Notify.toast("success","등록 완료"));case 4:case"end":return a.stop()}}),a)})))()},edit:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.isModalViewed=!0,this.actTarget=e,this.editIndex=t,this.frm_ledger=this.ledger.data[t],"child"==e&&(this.frm_ledger_model=this.ledger.data[t].ledger_model[a],this.frm_ledger_model.lm_lg_id=this.ledger.data[t].lg_id),this.actType="edit"},update:function(e){var t=this;return d(n().mark((function a(){var r,l;return n().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e=Object.assign({},e,{_method:"PATCH"}),r=e.lg_id?e.lg_id:e.lm_lg_id,a.next=4,i.Z.post("/api/admin/ledger/".concat(r),e);case 4:(l=a.sent)&&200===l.status&&(t.index(),Notify.toast("success","수정 완료")),"child"==t.actTarget&&t.all_price_update();case 7:case"end":return a.stop()}}),a)})))()},register:function(){var e={};"papa"==this.actTarget?e=Object.assign({},this.frm_ledger):"child"==this.actTarget&&(e=Object.assign({},this.frm_ledger_model)),"create"==this.actType?this.store(e):"edit"==this.actType&&this.update(e),this.frm_ledger={lg_pay_type:"CARD",lg_source_type:"ORD",lg_od_id:0,ledger_model:[]},this.frm_ledger_model={},this.isModalViewed=!1},all_price_update:function(){var e=this;return d(n().mark((function t(){var a,r,l,d,o;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=0,r=0,l=0,e.ledger.data[e.editIndex].ledger_model.forEach((function(e){"Y"!==e.lm_cxl&&(a+=Number(e.lm_ea_price),r+=Number(e.lm_surtax),l+=Number(e.lm_sum_price))})),e.ledger.data[e.editIndex].lg_sum_ea_p=a,e.ledger.data[e.editIndex].lg_sum_surtax=r,e.ledger.data[e.editIndex].lg_sum_sum_p=l,d={_method:"PATCH",type:"all_price_update",lg_sum_ea_p:a,lg_sum_surtax:r,lg_sum_sum_p:l},t.next=10,i.Z.post("/api/admin/ledger/".concat(e.ledger.data[e.editIndex].lg_id),d);case 10:(o=t.sent)&&200===o.status&&(e.index(),Notify.toast("success","수정 완료"));case 12:case"end":return t.stop()}}),t)})))()},chkChange:function(){var e=this.ledger.data.filter((function(e){return 1==e.chk_cplt})).length;0===e?(this.indeterminate=!1,this.allSelected=!1):e===this.ledger.data.length?(this.indeterminate=!1,this.allSelected=!0):(this.indeterminate=!0,this.allSelected=!1)},toggle_all_chk:function(e){this.ledger.data.forEach((function(t){t.chk_cplt=!!e})),this.indeterminate=!1},to_accounting:function(){var e=this;return d(n().mark((function t(){var a,r,l;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={_method:"PATCH",type:"to_accounting",lg_ids:e.ledger.data.filter((function(e){return 1==e.chk_cplt})).map((function(e){return e.lg_id}))},t.next=3,i.Z.post("/api/admin/ledger/0",a);case 3:if(!(r=t.sent)||200!==r.status){t.next=9;break}return t.next=7,i.Z.post("/api/admin/ledgerAcct",{lg:e.ledger.data});case 7:(l=t.sent)&&200===l.status&&(e.index(),Notify.toast("success","수정 완료"));case 9:case"end":return t.stop()}}),t)})))()}},mounted:function(){this.index()}};var s=a(3379),u=a.n(s),g=a(8807),p={insert:"head",singleton:!1};u()(g.Z,p);g.Z.locals;const h=(0,a(1900).Z)(_,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"p_warp",attrs:{id:"admLedger"}},[a("h3",{staticClass:"p_tit"},[e._v("영업 장부")]),e._v(" "),a("Search",{attrs:{search:e.user_mng_config.SEARCH,sch_item_list:e.sch_item_list,mng_list:e.mng_list,writer:e.writer,config:e.config},on:{index:e.index,editSearch:e.editSearch},model:{value:e.schFrm,callback:function(t){e.schFrm=t},expression:"schFrm"}}),e._v(" "),a("b-card",{staticClass:"shadow data"},[a("b-row",{staticClass:"list_top"},[a("b-col",[e._v("\r\n                Total : "),a("b-badge",{attrs:{variant:"info"}},[e._v(e._s(e.ledger.total))]),e._v(" "),a("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:"정보 나열 순서",expression:"'정보 나열 순서'",modifiers:{hover:!0}}],staticClass:"ml-4",attrs:{size:"sm"},on:{click:e.editColumn}},[a("b-icon-gear")],1)],1),e._v(" "),a("b-col",[a("b-button",{attrs:{variant:"info",size:"sm"},on:{click:function(t){return e.create("papa")}}},[a("b-icon-plus-lg"),e._v(" 추가")],1)],1)],1),e._v(" "),a("perfect-scrollbar",{attrs:{suppressScrollX:"true"}},[a("ListHead",{attrs:{ledger:e.ledger.data,mng_config_column:e.user_mng_config.COLUMN,column_list_clmn:e.column_list_clmn,mng_config_model:e.user_mng_config.MODEL,column_list_model:e.column_list_model,row_width:e.row_width,model_width:e.model_width,total_ea_price:e.total_ea_price,total_sum_price:e.total_sum_price,indeterminate:e.indeterminate,all_chk_cplt:e.all_chk_cplt},on:{index:e.index,toggle_all_chk:e.toggle_all_chk}}),e._v(" "),a("ListData",{attrs:{ledger:e.ledger.data,mng_config_column:e.user_mng_config.COLUMN,column_list_clmn:e.column_list_clmn,mng_config_model:e.user_mng_config.MODEL,column_list_model:e.column_list_model,row_width:e.row_width,model_width:e.model_width,indeterminate:e.indeterminate,all_chk_cplt:e.all_chk_cplt,config:e.config},on:{index:e.index,create:e.create,edit:e.edit,chkChange:e.chkChange}})],1),e._v(" "),a("pagination",{staticClass:"mt-5",attrs:{data:e.ledger,align:"center"},on:{"pagination-change-page":e.index}})],1),e._v(" "),a("transition",{attrs:{name:"modal"}},[e.isModalViewed?a("Modal",{on:{"close-modal":function(t){e.isModalViewed=!1}}},["papa"==e.actTarget?a("FormLedger",{attrs:{pay_type_option:e.config.pay_type},on:{register:e.register},model:{value:e.frm_ledger,callback:function(t){e.frm_ledger=t},expression:"frm_ledger"}}):"child"==e.actTarget?a("FormLedgerModel",{attrs:{lg:e.frm_ledger},on:{register:e.register},model:{value:e.frm_ledger_model,callback:function(t){e.frm_ledger_model=t},expression:"frm_ledger_model"}}):"editSearch"==e.actTarget?a("CustomSetSearch",{attrs:{db_data_config_sch:e.user_mng_config.SEARCH,sch_item_list:e.sch_item_list},on:{updateSearchComplete:e.updateSearchComplete}}):"editColumn"==e.actTarget?a("CustomSetColumn",{attrs:{db_config_clmn:e.user_mng_config.COLUMN,db_config_model:e.user_mng_config.MODEL,column_list_clmn:e.column_list_clmn,column_list_model:e.column_list_model},on:{updateColumnComplete:e.updateColumnComplete}}):e._e()],1):e._e()],1),e._v(" "),a("transition",{attrs:{name:"slideLeftRight"}},[e.ledger.data.filter((function(e){return 1==e.chk_cplt})).length?a("b-button",{staticClass:"to_accounting",on:{click:e.to_accounting}},[e._v("회계전송")]):e._e()],1)],1)}),[],!1,null,null,null).exports}}]);